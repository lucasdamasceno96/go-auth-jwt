<!DOCTYPE html>
<html>
<head>
    <title>Login</title>
    <link href="login.css" rel="stylesheet" />
    <script>
        function loginUser(event) {
            event.preventDefault(); // Impede o envio do formulário

            // Obtém os valores dos campos de e-mail e senha
            var email = document.getElementById("email").value;
            var password = document.getElementById("password").value;

            // Verifica se o domínio de e-mail é "@spiderman"
            if (email.endsWith("@spiderman.com")) {
                // Constrói o objeto de dados para enviar ao endpoint
                var data = {
                    email: email,
                    password: password
                };

                // Envia os dados para o endpoint usando o método POST
                fetch("http://localhost:8080/login", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(data)
                })
                .then(function(response) {
                    if (response.ok) {
                        // Login bem-sucedido, redireciona para a página home.html
                        window.location.href = "../home/home.html";
                    } else {
                        // Login falhou
                        alert("Login inválido. Verifique seu e-mail e senha.");
                    }
                })
                .catch(function(error) {
                    // Erro de conexão ou outra falha
                    alert("Erro ao conectar ao servidor. Verifique a URL do endpoint.");
                });
            } else {
                alert("O domínio de e-mail deve ser '@spiderman'.");
            }
        }
    </script>
</head>
<body>
    
   <nav>
        <a href="#" class="logo"> Spiderman</a>
        <ul>
          <li><a href="../index.html"> Home </a></li>
          <li><a href="https://github.com/lucasdamasceno96"> Contact </a></li>
        </ul>
    </nav>

<div class="container">
        <h1>Login</h1>
    <form id="loginForm" onsubmit="loginUser(event)">
        <div>
            <label for="email">E-mail:</label>
            <input type="email" id="email" required>
        </div>
        <div>
            <label for="password">Senha:</label>
            <input type="password" id="password" required>
        </div>
        <div>
            <button class="btn" type="submit">Login</button>
        </div>
    </form>
</div>

</body>
</html>
